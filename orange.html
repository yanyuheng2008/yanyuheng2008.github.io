<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"> <title>å°é©¬æ©˜å›­ - 2702å…¶è²Œ...</title> <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            background: linear-gradient(to bottom, #87CEEB, #ffffff); /* å¤©ç©ºåˆ°åœ°é¢çš„æ¸å˜ */
            overflow: hidden;
            color: #333;
        }

        .game-container {
            background-color: rgba(255, 255, 255, 0.9);
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            padding: 30px;
            text-align: center;
            width: 90%;
            max-width: 600px;
            position: relative;
            overflow: hidden;
            animation: fadeIn 1s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        h1 {
            color: #FF7F50; /* çŠç‘šè‰²ï¼Œåƒæ©˜å­ */
            margin-bottom: 5px; /* è°ƒæ•´æ ‡é¢˜ä¸‹è¾¹è· */
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }
        .author-info {
            font-size: 0.9em;
            color: #666;
            margin-bottom: 20px;
        }

        .stats-panel {
            display: flex;
            justify-content: space-around;
            margin-bottom: 25px;
            padding: 10px;
            background-color: #FFFACD; /* æŸ æª¬ç»¸è‰² */
            border-radius: 10px;
            box-shadow: inset 0 0 5px rgba(0,0,0,0.1);
        }

        .stats-panel p {
            margin: 0;
            font-weight: bold;
            color: #4CAF50; /* ç»¿è‰² */
            display: flex;
            align-items: center;
        }

        .stats-panel span {
            color: #FF7F50;
            margin-left: 5px;
            font-size: 1.1em;
        }

        .garden {
            position: relative;
            width: 100%;
            height: 300px;
            background: #8B4513; /* æ³¥åœŸè‰² */
            border-radius: 15px;
            margin-bottom: 30px;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: flex-end;
            box-shadow: inset 0 -5px 10px rgba(0,0,0,0.2);
        }

        .tree {
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 150px; /* åŸºç¡€å®½åº¦ */
            height: 250px; /* åŸºç¡€é«˜åº¦ */
            transition: all 0.5s ease-out; /* å¹³æ»‘è¿‡æ¸¡åŠ¨ç”» */
        }

        /* æ ‘å¹² */
        .tree .trunk {
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 30px;
            height: 80px;
            background-color: #8B4513;
            border-radius: 5px 5px 0 0;
            transition: height 0.5s ease-out;
        }

        /* æ ‘å¶ */
        .tree .leaves {
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 150px;
            height: 150px;
            background-color: #4CAF50; /* ç»¿è‰² */
            border-radius: 50%;
            transition: all 0.5s ease-out;
            box-shadow: inset 0 0 10px rgba(0,0,0,0.2);
        }

        /* æœå®å±‚ï¼ˆæœ€åˆéšè—ï¼‰ */
        .tree .fruit-layer {
            position: absolute;
            top: 50%; /* ç›¸å¯¹äºæ ‘å¶ä¸­å¿ƒ */
            left: 50%;
            transform: translate(-50%, -50%);
            width: 100px;
            height: 100px;
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            opacity: 0;
            transition: opacity 0.8s ease-out, transform 0.8s ease-out;
        }

        /* æ©˜å­æ ‘ç”Ÿé•¿é˜¶æ®µæ ·å¼ */
        .tree.stage-0 { /* ç§å­/å¹¼è‹— */
            width: 50px;
            height: 80px;
        }
        .tree.stage-0 .trunk { height: 30px; width: 10px; }
        .tree.stage-0 .leaves { width: 30px; height: 30px; background-color: #A5D6A7; } /* å«©ç»¿è‰² */

        .tree.stage-1 { /* å°æ ‘ */
            width: 100px;
            height: 150px;
        }
        .tree.stage-1 .trunk { height: 60px; width: 20px; }
        .tree.stage-1 .leaves { width: 80px; height: 80px; background-color: #81C784; }

        .tree.stage-2 { /* ä¸­ç­‰æ ‘ */
            width: 150px;
            height: 220px;
        }
        .tree.stage-2 .trunk { height: 90px; width: 25px; }
        .tree.stage-2 .leaves { width: 120px; height: 120px; background-color: #66BB6A; }

        .tree.stage-3 { /* å¤§æ ‘ */
            width: 200px;
            height: 280px;
        }
        .tree.stage-3 .trunk { height: 120px; width: 30px; }
        .tree.stage-3 .leaves { width: 180px; height: 180px; background-color: #4CAF50; }

        .tree.stage-4 { /* ç»“æœæ ‘ */
            width: 220px;
            height: 300px;
        }
        .tree.stage-4 .trunk { height: 130px; width: 35px; }
        .tree.stage-4 .leaves { width: 200px; height: 200px; background-color: #4CAF50; }
        .tree.stage-4 .fruit-layer {
            opacity: 1;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="50" cy="50" r="40" fill="%23FFA500"/><circle cx="30" cy="30" r="10" fill="%23FFD700"/><circle cx="70" cy="40" r="12" fill="%23FFD700"/><circle cx="45" cy="70" r="11" fill="%23FFD700"/></svg>'); /* ç®€åŒ–çš„SVGæ©˜å­å›¾æ ‡ */
        }

        /* çŠ¶æ€å›¾æ ‡ */
        .status-icon {
            position: absolute;
            font-size: 2.5em;
            cursor: pointer;
            animation: bounce 1s infinite alternate; /* å¼¹è·³åŠ¨ç”» */
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
            z-index: 10;
            display: none; /* é»˜è®¤éšè— */
        }

        .status-icon.water-needed {
            top: -10px;
            left: 20%;
            color: #00BFFF; /* æ·±å¤©è“è‰² */
        }

        .status-icon.fertilizer-needed {
            top: -10px;
            right: 20%;
            color: #8B4513; /* åœŸå£¤è‰² */
        }

        .tree.dry .status-icon.water-needed,
        .tree.no-fertilizer .status-icon.fertilizer-needed,
        .tree.ready-to-harvest .status-icon.harvest-ready { /* å‡è®¾æœ‰ä¸€ä¸ªæ”¶è·å›¾æ ‡ */
            display: block; /* éœ€è¦æ—¶æ˜¾ç¤º */
        }

        /* æ©˜å­æ ‘å¥åº·çŠ¶æ€ */
        .tree.dry .leaves {
            background-color: #B2DFDB; /* æµ…ç°è‰²ç»¿ */
            filter: brightness(0.8);
        }

        .tree.no-fertilizer .leaves {
            background-color: #FFEBEE; /* æµ…ç²‰è‰²ï¼Œæ¨¡æ‹Ÿè¥å…»ä¸è‰¯ */
            filter: grayscale(0.2);
        }

        /* åŠ¨ç”»æ•ˆæœ */
        @keyframes bounce {
            from { transform: translateY(0); }
            to { transform: translateY(-10px); }
        }

        @keyframes grow {
            from { transform: scale(0.5); }
            to { transform: scale(1); }
        }

        @keyframes fruitPop {
            from { transform: translate(-50%, -50%) scale(0.5); opacity: 0; }
            to { transform: translate(-50%, -50%) scale(1); opacity: 1; }
        }

        /* æ§åˆ¶æŒ‰é’® */
        .controls {
            margin-top: 20px;
            display: flex;
            justify-content: center;
            flex-wrap: wrap; /* å…è®¸æ¢è¡Œ */
            gap: 15px;
        }

        .tool-btn {
            background-color: #4CAF50; /* ç»¿è‰² */
            color: white;
            border: none;
            padding: 12px 25px;
            font-size: 1.1em;
            border-radius: 10px;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.1s ease;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .tool-btn:hover {
            background-color: #45a049;
            transform: translateY(-2px);
        }

        .tool-btn:active {
            transform: translateY(1px);
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .tool-btn#harvest-btn {
            background-color: #FF9800; /* æ©˜è‰² */
        }

        .tool-btn#harvest-btn:hover {
            background-color: #FB8C00;
        }

        .tool-btn#cut-orange-btn {
            background-color: #E91E63; /* ç²‰è‰² */
        }
        .tool-btn#cut-orange-btn:hover {
            background-color: #D81B60;
        }

        .tool-btn#mushroom-collection-btn {
            background-color: #673AB7; /* ç´«è‰² */
        }
        .tool-btn#mushroom-collection-btn:hover {
            background-color: #5E35B1;
        }
        .tool-btn#game-info-btn { /* æ–°å¢æ¸¸æˆè¯´æ˜æŒ‰é’®æ ·å¼ */
            background-color: #2196F3; /* è“è‰² */
        }
        .tool-btn#game-info-btn:hover {
            background-color: #1976D2;
        }


        .message-area {
            margin-top: 20px;
            color: #D32F2F; /* çº¢è‰²è­¦å‘Š */
            font-weight: bold;
            min-height: 25px;
            animation: fadeOut 3s forwards; /* æ¶ˆæ¯æ·¡å‡º */
        }

        @keyframes fadeOut {
            0% { opacity: 1; }
            80% { opacity: 1; }
            100% { opacity: 0; }
        }

        /* äº’åŠ¨ç‰¹æ•ˆ - ç²’å­æ•ˆæœï¼ˆJSæ§åˆ¶ï¼‰ */
        .effect-particle {
            position: absolute;
            background-color: rgba(0, 191, 255, 0.7); /* æ°´æ»´è‰² */
            border-radius: 50%;
            animation: drip 1s forwards ease-out;
            pointer-events: none; /* ä¸é˜»æ­¢é¼ æ ‡äº‹ä»¶ */
            z-index: 100;
        }

        .effect-particle.fertilizer {
            background-color: rgba(139, 69, 19, 0.7); /* è‚¥æ–™è‰² */
            animation: scatter 1s forwards ease-out;
        }

        @keyframes drip {
            from { transform: translateY(0) scale(1); opacity: 1; }
            to { transform: translateY(50px) scale(0.5); opacity: 0; }
        }

        @keyframes scatter {
            from { transform: translateY(0) scale(1); opacity: 1; }
            to { transform: translateY(30px) translateX(calc(var(--rand-x) * 1px)) scale(0.2); opacity: 0; }
        }

        /* è˜‘è‡æ ·å¼ */
        .mushroom {
            position: absolute;
            width: 50px;
            height: 50px;
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            cursor: pointer;
            animation: bounce 1.5s infinite alternate; /* è˜‘è‡ä¹Ÿå¼¹è·³ */
            z-index: 5;
            bottom: 10px; /* ç¡®ä¿åœ¨åœ°é¢ä¸Š */
        }

        /* ä¸åŒè˜‘è‡çš„èƒŒæ™¯å›¾ - ä½¿ç”¨ SVG Data URI */
        .mushroom.shiitake { background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="50" cy="50" r="40" fill="%238B4513"/><path d="M40 50 L45 80 L55 80 L60 50 Z" fill="%23D2B48C"/></svg>'); } /* é¦™è‡ */
        .mushroom.amanita { background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="50" cy="50" r="40" fill="%23FF4500"/><circle cx="30" cy="30" r="8" fill="%23ffffff"/><circle cx="70" cy="40" r="10" fill="%23ffffff"/><circle cx="45" cy="70" r="7" fill="%23ffffff"/><rect x="45" y="80" width="10" height="20" fill="%23ffffff"/></svg>'); } /* æ¯’è‡ä¼ (çº¢è‰²å¸¦ç™½ç‚¹) */
        .mushroom.oyster { background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path d="M20 50 C20 20, 80 20, 80 50 L60 80 L40 80 Z" fill="%23D3D3D3"/><rect x="45" y="80" width="10" height="20" fill="%23C0C0C0"/></svg>'); } /* å¹³è‡ (ç°è‰²) */
        .mushroom.ganoderma { background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path d="M20 50 C20 20, 80 20, 80 50 C80 80, 50 100, 20 80 Z" fill="%23A0522D"/><path d="M25 55 C25 30, 75 30, 75 55 C75 75, 50 90, 25 75 Z" fill="%238B4513"/></svg>'); } /* çµèŠ */
        .mushroom.enoki { background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="50" cy="5" r="5" fill="%23F5F5DC"/><rect x="48" y="5" width="4" height="90" fill="%23D3D3D3"/></svg>'); } /* é‡‘é’ˆè‡ */


        /* æ¨¡æ€æ¡† (Modal) åŸºç¡€æ ·å¼ */
        .modal {
            display: none; /* é»˜è®¤éšè— */
            position: fixed; /* å›ºå®šå®šä½ */
            z-index: 200; /* ç¡®ä¿åœ¨æœ€ä¸Šå±‚ */
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto; /* å¦‚æœå†…å®¹è¿‡å¤šï¼Œå…è®¸æ»šåŠ¨ */
            background-color: rgba(0,0,0,0.6); /* åŠé€æ˜é»‘è‰²èƒŒæ™¯ */
            backdrop-filter: blur(5px); /* èƒŒæ™¯æ¨¡ç³Šæ•ˆæœ */
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background-color: #fefefe;
            margin: auto; /* è‡ªåŠ¨å±…ä¸­ */
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            width: 80%;
            max-width: 500px;
            text-align: center;
            position: relative;
            animation: slideIn 0.5s ease-out;
        }

        @keyframes slideIn {
            from { transform: translateY(-50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .close-button {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            position: absolute;
            top: 10px;
            right: 20px;
        }

        .close-button:hover,
        .close-button:focus {
            color: black;
            text-decoration: none;
            cursor: pointer;
        }

        /* åˆ‡æ©˜å­æ¨¡æ€æ¡†ç‰¹æœ‰æ ·å¼ */
        #orange-to-cut {
            width: 150px;
            height: 150px;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="50" cy="50" r="45" fill="%23FFA500"/></svg>'); /* å•ä¸ªæ©˜å­å›¾æ ‡ */
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            margin: 20px auto;
            cursor: pointer; /* å¯ä»¥æ·»åŠ ç‚¹å‡»åŠ¨ç”» */
            transition: transform 0.1s ease-out;
        }

        #orange-to-cut:active {
            transform: scale(0.95);
        }

        .quote {
            margin-top: 20px;
            font-style: italic;
            color: #555;
            font-size: 1.1em;
            min-height: 40px; /* ä¿è¯é«˜åº¦ï¼Œé˜²æ­¢å¸ƒå±€è·³åŠ¨ */
        }

        /* è˜‘è‡å›¾é‰´æ ·å¼ */
        .gallery {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 15px;
            margin-top: 20px;
            max-height: 400px; /* é™åˆ¶é«˜åº¦ï¼Œå¯æ»šåŠ¨ */
            overflow-y: auto;
            padding: 10px;
            border: 1px solid #eee;
            border-radius: 10px;
            background-color: #fafafa;
        }

        .mushroom-card {
            background-color: #fff;
            border: 1px solid #ddd;
            border-radius: 10px;
            padding: 10px;
            text-align: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        .mushroom-card img {
            width: 60px;
            height: 60px;
            margin-bottom: 5px;
            opacity: 0.3; /* æœªæ”¶é›†çš„æ˜¾ç¤ºä¸ºç°è‰² */
        }

        .mushroom-card.collected img {
            opacity: 1; /* æ”¶é›†åˆ°çš„æ­£å¸¸æ˜¾ç¤º */
        }

        .mushroom-card p {
            margin: 0;
            font-size: 0.9em;
            color: #666;
        }

        .mushroom-card.collected p {
            color: #333;
            font-weight: bold;
        }

        /* è˜‘è‡ç”ŸæˆåŒºåŸŸï¼Œç”¨äºå®šä½è˜‘è‡ */
        #mushroom-spawn-area {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 80px; /* è˜‘è‡å°†åœ¨åœ°é¢ä¸Šæ–¹çš„è¿™ä¸ªåŒºåŸŸå†…ç”Ÿæˆ */
            pointer-events: none; /* é»˜è®¤ä¸æ¥å—é¼ æ ‡äº‹ä»¶ï¼Œè®©ç‚¹å‡»ç©¿é€åˆ°ä¸‹é¢çš„æ³¥åœŸ */
        }
        /* å½“æœ‰è˜‘è‡æ—¶ï¼Œéœ€è¦å°† pointer-events è®¾ä¸º autoï¼Œè®©è˜‘è‡å¯ç‚¹å‡» */
        #mushroom-spawn-area .mushroom {
            pointer-events: auto;
        }

        /* æ¸¸æˆè¯´æ˜æ¨¡æ€æ¡†å†…å®¹æ ·å¼ */
        .game-info-content {
            text-align: left;
            font-size: 1em;
            line-height: 1.6;
        }
        .game-info-content h3 {
            color: #4CAF50;
            margin-top: 15px;
            margin-bottom: 10px;
        }
        .game-info-content ul {
            list-style-type: disc;
            margin-left: 20px;
            padding-left: 0;
        }
        .game-info-content li {
            margin-bottom: 5px;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <h1>å°é©¬æ©˜å›­</h1>
        <p class="author-info">æ¸¸æˆä½œè€…ï¼š2702å…¶è²Œ...ï¼ˆbushiï¼‰</p>

        <div class="stats-panel">
            <p>é‡‘å¸: <span id="gold-display">0</span></p>
            <p>ç»éªŒ: <span id="exp-display">0</span></p>
            <p>æ©˜å­æ€»æ•°: <span id="total-oranges-display">0</span></p>
        </div>

        <div class="garden">
            <div id="orange-tree" class="tree stage-0 dry no-fertilizer">
                <div class="trunk"></div>
                <div class="leaves"></div>
                <div class="fruit-layer"></div>
                <div class="status-icon water-needed">ğŸ’§</div>
                <div class="status-icon fertilizer-needed">ğŸŒ±</div>
            </div>
            <div id="mushroom-spawn-area"></div>
        </div>

        <div class="controls">
            <button id="water-btn" class="tool-btn">ğŸ’§ æµ‡æ°´</button>
            <button id="fertilize-btn" class="tool-btn">ğŸŒ± æ–½è‚¥</button>
            <button id="harvest-btn" class="tool-btn" style="display: none;">ğŸŠ æ”¶è·</button>
            <button id="cut-orange-btn" class="tool-btn" style="display: none;">ğŸ”ª åˆ‡æ©˜å­</button>
            <button id="mushroom-collection-btn" class="tool-btn">ğŸ„ è˜‘è‡å›¾é‰´</button>
            <button id="game-info-btn" class="tool-btn">â„¹ï¸ æ¸¸æˆè¯´æ˜</button> </div>

        <div id="message-area" class="message-area"></div>

        <div id="cut-orange-modal" class="modal">
            <div class="modal-content">
                <span class="close-button">&times;</span>
                <h2>åˆ‡å¼€æ©˜å­</h2>
                <div id="orange-to-cut"></div>
                <button id="perform-cut-btn" class="tool-btn">ç”¨åŠ›åˆ‡å¼€ï¼</button>
                <p id="philosophy-quote" class="quote"></p>
            </div>
        </div>

        <div id="mushroom-collection-modal" class="modal">
            <div class="modal-content">
                <span class="close-button">&times;</span>
                <h2>æˆ‘çš„è˜‘è‡å›¾é‰´</h2>
                <div id="mushroom-gallery" class="gallery">
                    </div>
            </div>
        </div>

        <div id="game-info-modal" class="modal">
            <div class="modal-content">
                <span class="close-button">&times;</span>
                <h2>æ¸¸æˆè¯´æ˜</h2>
                <div class="game-info-content">
                    <p>æ¬¢è¿æ¥åˆ° **å°é©¬æ©˜å›­**ï¼è¿™æ˜¯ä¸€ä¸ªç»™å°é©¬é‡èº«å®šåˆ¶çš„æ¨¡æ‹Ÿç§æ¤æ©˜å­çš„ä¼‘é—²å°æ¸¸æˆã€‚</p>
                    <h3>ç©æ³•æç¤ºï¼š</h3>
                    <ul>
                        <li>**ç…§æ–™æ©˜å­æ ‘ï¼š** é€šè¿‡ç‚¹å‡» **ğŸ’§ æµ‡æ°´** å’Œ **ğŸŒ± æ–½è‚¥** æŒ‰é’®æ¥ç…§æ–™æ‚¨çš„æ©˜å­æ ‘ï¼Œå¸®åŠ©å®ƒæˆé•¿ã€‚</li>
                        <li>**æ©˜å­æˆé•¿ï¼š** æ©˜å­æ ‘ä¼šç»å†å¤šä¸ªç”Ÿé•¿é˜¶æ®µï¼Œæœ€ç»ˆç»“å‡ºæˆç†Ÿçš„æ©˜å­ã€‚</li>
                        <li>**æ”¶è·æ©˜å­ï¼š** å½“æ©˜å­æ ‘ç»“æ»¡æœå®åï¼Œç‚¹å‡» **ğŸŠ æ”¶è·** æŒ‰é’®å³å¯é‡‡æ‘˜æ©˜å­ï¼Œè·å¾—é‡‘å¸å’Œç»éªŒã€‚</li>
                        <li>**åˆ‡å¼€æ©˜å­ï¼š** æ”¶è·çš„æ©˜å­ä¼šè®¡å…¥æ‚¨çš„ **æ©˜å­æ€»æ•°**ã€‚æ‚¨å¯ä»¥ç‚¹å‡» **ğŸ”ª åˆ‡æ©˜å­** æŒ‰é’®ï¼Œåˆ‡å¼€ä¸€ä¸ªæ©˜å­ï¼Œæ¯æ¬¡éƒ½èƒ½è·å¾—ä¸€å¥æ©˜å­çš„è¯è¯­ï¼</li>
                        <li>**è˜‘è‡æƒŠå–œï¼š** å‹¤åŠ³çš„å›­ä¸ä¼šå‘ç°æƒŠå–œï¼æœ‰æ—¶å€™ï¼Œæ©˜å­æ ‘ä¸‹ä¼šé•¿å‡ºå„ç§ **è˜‘è‡**ã€‚ç‚¹å‡»å®ƒä»¬è¿›è¡Œé‡‡æ‘˜ã€‚</li>
                        <li>**è˜‘è‡å›¾é‰´ï¼š** æ‚¨åœ¨æ¸¸æˆä¸­æ”¶é›†åˆ°çš„æ‰€æœ‰è˜‘è‡éƒ½å¯ä»¥åœ¨ **ğŸ„ è˜‘è‡å›¾é‰´** ä¸­æŸ¥çœ‹ï¼Œçœ‹çœ‹æ‚¨èƒ½æ”¶é›†åˆ°å¤šå°‘ç¨€æœ‰å“ç§ï¼</li>
                    </ul>
                    <p>æ‰€æœ‰æ¸¸æˆæ•°æ®éƒ½ä¼šå®æ—¶ä¿å­˜åœ¨æ‚¨çš„æµè§ˆå™¨ä¸­ï¼Œæ‚¨å¯ä»¥éšæ—¶å…³é—­é¡µé¢ï¼Œä¸‹æ¬¡æ‰“å¼€æ—¶ç»§ç»­æ‚¨çš„æ©˜å›­ç”Ÿæ´»ã€‚</p>
                </div>
            </div>
        </div>

    </div>

    <script>
        // è·å–DOMå…ƒç´ 
        const orangeTree = document.getElementById('orange-tree');
        const waterBtn = document.getElementById('water-btn');
        const fertilizeBtn = document.getElementById('fertilize-btn');
        const harvestBtn = document.getElementById('harvest-btn');
        const goldDisplay = document.getElementById('gold-display');
        const expDisplay = document.getElementById('exp-display');
        const totalOrangesDisplay = document.getElementById('total-oranges-display');
        const cutOrangeBtn = document.getElementById('cut-orange-btn');
        const cutOrangeModal = document.getElementById('cut-orange-modal');
        const performCutBtn = document.getElementById('perform-cut-btn');
        const philosophyQuote = document.getElementById('philosophy-quote');
        const orangeToCut = document.getElementById('orange-to-cut');
        const mushroomSpawnArea = document.getElementById('mushroom-spawn-area');
        const mushroomCollectionBtn = document.getElementById('mushroom-collection-btn');
        const mushroomCollectionModal = document.getElementById('mushroom-collection-modal');
        const mushroomGallery = document.getElementById('mushroom-gallery');
        const gameInfoBtn = document.getElementById('game-info-btn'); // æ–°å¢æ¸¸æˆè¯´æ˜æŒ‰é’®
        const gameInfoModal = document.getElementById('game-info-modal'); // æ–°å¢æ¸¸æˆè¯´æ˜æ¨¡æ€æ¡†
        const messageArea = document.getElementById('message-area');

        const closeButtons = document.querySelectorAll('.close-button'); // è·å–æ‰€æœ‰å…³é—­æŒ‰é’®

        // æ¸¸æˆçŠ¶æ€å˜é‡
        let gameState = {
            gold: 0,
            exp: 0,
            treeStage: 0, // 0:ç§å­, 1:å¹¼è‹—, 2:å°æ ‘, 3:ä¸­æ ‘, 4:å¤§æ ‘(ç»“æœ)
            waterLevel: 50, // 0-100ï¼Œä½äº50éœ€è¦æ°´
            fertilizerLevel: 50, // 0-100ï¼Œä½äº50éœ€è¦è‚¥
            growthProgress: 0, // å½“å‰é˜¶æ®µçš„æˆé•¿è¿›åº¦ï¼Œè¾¾åˆ°100è¿›å…¥ä¸‹ä¸€é˜¶æ®µ
            lastSaveTime: Date.now(),
            totalOranges: 0,
            collectedMushrooms: {}, // å­˜å‚¨å·²æ”¶é›†çš„è˜‘è‡ç§ç±»å’Œæ•°é‡ { 'shiitake': 1, 'amanita': 0, ... }
            currentMushroom: null // å½“å‰ç”Ÿæˆçš„è˜‘è‡DOMå…ƒç´ 
        };

        const MAX_TREE_STAGE = 4;
        const GROWTH_NEEDED_PER_STAGE = 100; // æ¯ä¸ªé˜¶æ®µéœ€è¦100ç‚¹æˆé•¿å€¼
        const WATER_DECAY_RATE = 2; // æ¯ç§’æ°´ä»½æµå¤±
        const FERTILIZER_DECAY_RATE = 1; // æ¯ç§’è‚¥æ–™æµå¤±
        const WATER_GAIN_PER_ACTION = 30;
        const FERTILIZER_GAIN_PER_ACTION = 30;
        const GROWTH_GAIN_PER_WATER = 5;
        const GROWTH_GAIN_PER_FERTILIZER = 10;
        const HARVEST_GOLD = 50;
        const HARVEST_EXP = 20;

        // --- éŸ³æ•ˆæ–‡ä»¶è·¯å¾„ (è¯·æ›¿æ¢ä¸ºå®é™…çš„éŸ³é¢‘æ–‡ä»¶) ---
        // æ³¨æ„ï¼šå¦‚æœä¸æƒ³ä½¿ç”¨éŸ³æ•ˆï¼Œå¯ä»¥æ³¨é‡Šæ‰è¿™äº›è¡Œã€‚
        // å®é™…æ¸¸æˆä¸­ï¼Œè¿™äº›éŸ³æ•ˆæ–‡ä»¶éœ€è¦å­˜åœ¨äºæ‚¨çš„é¡¹ç›®ä¸­ã€‚
        // ç”±äºæ˜¯å•æ–‡ä»¶ï¼Œè¿™é‡Œæ— æ³•ç›´æ¥æä¾›éŸ³æ•ˆæ–‡ä»¶ï¼Œè¯·è‡ªè¡Œå‡†å¤‡ã€‚
        const sounds = {
            water: new Audio(''), // ç¤ºä¾‹è·¯å¾„ï¼Œæ›¿æ¢ä¸ºå®é™…çš„mp3æ–‡ä»¶
            fertilizer: new Audio(''),
            grow: new Audio(''),
            harvest: new Audio(''),
            error: new Audio(''),
            cut: new Audio(''),
            mushroomPick: new Audio(''),
            modalOpen: new Audio(''),
            modalClose: new Audio('')
        };

        // å“²ç†è¯­å½•åˆ—è¡¨
        const philosophyQuotes = [
            "çˆ±ä¸æ˜¯å‡è§†å¯¹æ–¹ï¼Œè€Œæ˜¯ä¸¤äººä¸€èµ·å‡è§†è¿œæ–¹ã€‚",
            "ç”Ÿå‘½ä¸æ¯ï¼Œå¥‹æ–—ä¸æ­¢ã€‚",
            "çœŸæ­£çš„å¹¸ç¦åœ¨äºå¯¹æ‰€æ‹¥æœ‰çš„ä¸€åˆ‡å¿ƒæ€€æ„Ÿæ¿€ã€‚",
            "ä½ çš„æ—¶é—´æœ‰é™ï¼Œä¸è¦æµªè´¹åœ¨é‡å¤åˆ«äººçš„ç”Ÿæ´»ä¸Šã€‚",
            "é‡è¦çš„ä¸æ˜¯ä½ æ‰€çœ‹ï¼Œè€Œæ˜¯ä½ æ‰€è§ã€‚",
            "çˆ±æ˜¯ç†è§£çš„å¼€å§‹ã€‚",
            "æ¯ä¸€ä¸ªä¸æ›¾èµ·èˆçš„æ—¥å­ï¼Œéƒ½æ˜¯å¯¹ç”Ÿå‘½çš„è¾œè´Ÿã€‚",
            "è€å¿ƒå’Œæ—¶é—´ï¼Œå¯ä»¥æŠŠæ¡‘å¶å˜æˆä¸ç»¸ã€‚",
            "æœ€å¤§çš„å†’é™©ï¼Œå°±æ˜¯ä»€ä¹ˆéƒ½ä¸åšã€‚",
            "ç”Ÿæ´»å°±åƒéª‘è‡ªè¡Œè½¦ï¼Œä¸ºäº†ä¿æŒå¹³è¡¡ï¼Œä½ å¿…é¡»ä¸æ–­å‰è¿›ã€‚",
            "æˆ‘ä»¬ä¸èƒ½é€‰æ‹©ç”Ÿå‘½çš„é•¿åº¦ï¼Œä½†å¯ä»¥é€‰æ‹©ç”Ÿå‘½çš„å®½åº¦ã€‚"
        ];

        // è˜‘è‡ç§ç±»å®šä¹‰ (åŒ…å« SVG data URI)
        const mushroomTypes = [
            { name: 'é¦™è‡', id: 'shiitake', rarity: 0.5, description: 'ä¸€ç§å¸¸è§çš„é£Ÿç”¨èŒï¼Œå‘³é“é²œç¾ã€‚', svg: 'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="50" cy="50" r="40" fill="%238B4513"/><path d="M40 50 L45 80 L55 80 L60 50 Z" fill="%23D2B48C"/></svg>' },
            { name: 'æ¯’è‡ä¼', id: 'amanita', rarity: 0.05, description: 'è™½ç„¶å¤–è§‚é²œè‰³ï¼Œä½†æœ‰å‰§æ¯’ï¼Œè¯·å‹¿é£Ÿç”¨ï¼', svg: 'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="50" cy="50" r="40" fill="%23FF4500"/><circle cx="30" cy="30" r="8" fill="%23ffffff"/><circle cx="70" cy="40" r="10" fill="%23ffffff"/><circle cx="45" cy="70" r="7" fill="%23ffffff"/><rect x="45" y="80" width="10" height="20" fill="%23ffffff"/></svg>' },
            { name: 'å¹³è‡', id: 'oyster', rarity: 0.4, description: 'å£æ„Ÿæ»‘å«©ï¼Œè¥å…»ä¸°å¯Œçš„èŒç±»ã€‚', svg: 'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path d="M20 50 C20 20, 80 20, 80 50 L60 80 L40 80 Z" fill="%23D3D3D3"/><rect x="45" y="80" width="10" height="20" fill="%23C0C0C0"/></svg>' },
            { name: 'çµèŠ', id: 'ganoderma', rarity: 0.02, description: 'ä¼ è¯´ä¸­çš„ä»™è‰ï¼Œå…·æœ‰è¯ç”¨ä»·å€¼ã€‚', svg: 'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path d="M20 50 C20 20, 80 20, 80 50 C80 80, 50 100, 20 80 Z" fill="%23A0522D"/><path d="M25 55 C25 30, 75 30, 75 55 C75 75, 50 90, 25 75 Z" fill="%238B4513"/></svg>' },
            { name: 'é‡‘é’ˆè‡', id: 'enoki', rarity: 0.3, description: 'ç»†é•¿æ´ç™½ï¼Œç«é”…çš„å¸¸å®¢ã€‚', svg: 'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="50" cy="5" r="5" fill="%23F5F5DC"/><rect x="48" y="5" width="4" height="90" fill="%23D3D3D3"/></svg>' }
        ];

        // ç¡®ä¿æ‰€æœ‰è˜‘è‡éƒ½æœ‰ä¸€ä¸ªåˆå§‹çš„ collectedMushrooms çŠ¶æ€
        mushroomTypes.forEach(m => {
            if (gameState.collectedMushrooms[m.id] === undefined) {
                gameState.collectedMushrooms[m.id] = 0;
            }
        });

        // --- æ•°æ®ä¿å­˜ä¸åŠ è½½ ---
        function saveGame() {
            localStorage.setItem('orangeTreeGame', JSON.stringify(gameState));
            gameState.lastSaveTime = Date.now();
            console.log('æ¸¸æˆå·²ä¿å­˜ï¼', gameState);
        }

        function loadGame() {
            const savedData = localStorage.getItem('orangeTreeGame');
            if (savedData) {
                // åˆå¹¶åŠ è½½çš„æ•°æ®ï¼Œç¡®ä¿æ–°ç‰ˆæœ¬çš„æ•°æ®ç»“æ„å…¼å®¹
                const loadedState = JSON.parse(savedData);
                gameState = { ...gameState, ...loadedState }; // åˆå¹¶ç°æœ‰å’ŒåŠ è½½çš„çŠ¶æ€

                // æ ¹æ®ä¸Šæ¬¡ä¿å­˜æ—¶é—´æ¨¡æ‹Ÿæµå¤±
                const timeElapsed = (Date.now() - gameState.lastSaveTime) / 1000; // ç§’
                gameState.waterLevel = Math.max(0, gameState.waterLevel - timeElapsed * WATER_DECAY_RATE);
                gameState.fertilizerLevel = Math.max(0, gameState.fertilizerLevel - timeElapsed * FERTILIZER_DECAY_RATE);

                // ç¡®ä¿æ–°åŠ å…¥çš„ collectedMushrooms é”®å­˜åœ¨ä¸”æœ‰é»˜è®¤å€¼
                mushroomTypes.forEach(m => {
                    if (gameState.collectedMushrooms[m.id] === undefined) {
                        gameState.collectedMushrooms[m.id] = 0;
                    }
                });

                updateGameDisplay();
                showMessage('æ¸¸æˆå·²åŠ è½½ï¼', 'info');
            } else {
                console.log('æœªæ‰¾åˆ°ä¿å­˜æ•°æ®ï¼Œå¼€å§‹æ–°æ¸¸æˆã€‚');
                showMessage('æ¬¢è¿æ¥åˆ°å°é©¬æ©˜å›­ï¼', 'info');
            }
        }

        // --- æ¸¸æˆæ˜¾ç¤ºæ›´æ–° ---
        function updateGameDisplay() {
            // æ›´æ–°é‡‘å¸ã€ç»éªŒå’Œæ©˜å­æ€»æ•°æ˜¾ç¤º
            goldDisplay.textContent = gameState.gold;
            expDisplay.textContent = gameState.exp;
            totalOrangesDisplay.textContent = gameState.totalOranges;

            // æ›´æ–°æ©˜å­æ ‘çš„CSSç±»ä»¥åæ˜ å…¶ç”Ÿé•¿é˜¶æ®µå’Œå¥åº·çŠ¶æ€
            orangeTree.className = `tree stage-${gameState.treeStage}`;

            if (gameState.waterLevel < 50) {
                orangeTree.classList.add('dry');
            } else {
                orangeTree.classList.remove('dry');
            }

            if (gameState.fertilizerLevel < 50) {
                orangeTree.classList.add('no-fertilizer');
            } else {
                orangeTree.classList.remove('no-fertilizer');
            }

            // æ˜¾ç¤ºæˆ–éšè—æ”¶è·æŒ‰é’®
            if (gameState.treeStage === MAX_TREE_STAGE && gameState.growthProgress >= GROWTH_NEEDED_PER_STAGE) {
                harvestBtn.style.display = 'inline-block';
                orangeTree.classList.add('ready-to-harvest');
            } else {
                harvestBtn.style.display = 'none';
                orangeTree.classList.remove('ready-to-harvest');
            }

            // æ˜¾ç¤ºæˆ–éšè—åˆ‡æ©˜å­æŒ‰é’®
            if (gameState.totalOranges > 0) {
                cutOrangeBtn.style.display = 'inline-block';
            } else {
                cutOrangeBtn.style.display = 'none';
            }
        }

        // --- æ¸¸æˆé€»è¾‘ ---

        function showMessage(msg, type = 'error', duration = 3000) {
            messageArea.textContent = msg;
            messageArea.className = `message-area ${type}`; // æ·»åŠ ç±»å‹ç±»ï¼Œä¾‹å¦‚ 'error', 'info', 'success'
            messageArea.style.opacity = 1; // ç¡®ä¿å¯è§
            messageArea.style.animation = 'none'; // é‡ç½®åŠ¨ç”»
            void messageArea.offsetWidth; // è§¦å‘å›æµä»¥é‡ç½®åŠ¨ç”»
            messageArea.style.animation = `fadeOut ${duration / 1000}s forwards`;
        }

        function playSound(soundName) {
            if (sounds[soundName] && sounds[soundName].src) { // æ£€æŸ¥æ˜¯å¦æœ‰éŸ³æº
                sounds[soundName].currentTime = 0; // ä»å¤´æ’­æ”¾
                sounds[soundName].play().catch(e => console.warn("æ’­æ”¾éŸ³æ•ˆå¤±è´¥:", e)); // ä½¿ç”¨warné¿å…é¢‘ç¹æŠ¥é”™
            }
        }

        // äº’åŠ¨ç‰¹æ•ˆï¼šç²’å­æ•ˆæœ
        function createParticleEffect(x, y, type) {
            const numParticles = type === 'water' ? 10 : 15;
            for (let i = 0; i < numParticles; i++) {
                const particle = document.createElement('div');
                particle.classList.add('effect-particle');
                if (type === 'fertilizer') {
                    particle.classList.add('fertilizer');
                }
                // éšæœºåˆå§‹ä½ç½®ç¨å¾®åç¦»ç‚¹å‡»ç‚¹
                particle.style.left = `${x + (Math.random() - 0.5) * 20}px`;
                particle.style.top = `${y + (Math.random() - 0.5) * 20}px`;
                // éšæœºå¤§å°
                const size = Math.random() * 8 + 4; // 4px to 12px
                particle.style.width = `${size}px`;
                particle.style.height = `${size}px`;

                // è®¾ç½®CSSå˜é‡ç”¨äºéšæœºåç§»
                particle.style.setProperty('--rand-x', (Math.random() - 0.5) * 100);

                document.body.appendChild(particle);

                // åŠ¨ç”»ç»“æŸåç§»é™¤ç²’å­
                particle.addEventListener('animationend', () => {
                    particle.remove();
                });
            }
        }

        function waterTree(event) {
            if (gameState.waterLevel >= 100) {
                showMessage('æ©˜å­æ ‘ç°åœ¨ä¸æ¸´ï¼');
                playSound('error');
                return;
            }

            gameState.waterLevel = Math.min(100, gameState.waterLevel + WATER_GAIN_PER_ACTION);
            gameState.growthProgress += GROWTH_GAIN_PER_WATER;
            showMessage('ä½ ç»™æ©˜å­æ ‘æµ‡äº†æ°´ã€‚', 'info');
            playSound('water');

            // ç²’å­ç‰¹æ•ˆ
            const rect = orangeTree.getBoundingClientRect();
            const treeCenterX = rect.left + rect.width / 2;
            const treeBottomY = rect.bottom;
            createParticleEffect(treeCenterX, treeBottomY, 'water');

            checkGrowth();
            updateGameDisplay();
            saveGame();
        }

        function fertilizeTree(event) {
            if (gameState.fertilizerLevel >= 100) {
                showMessage('æ©˜å­æ ‘ç°åœ¨ä¸ç¼ºè‚¥ï¼');
                playSound('error');
                return;
            }

            gameState.fertilizerLevel = Math.min(100, gameState.fertilizerLevel + FERTILIZER_GAIN_PER_ACTION);
            gameState.growthProgress += GROWTH_GAIN_PER_FERTILIZER;
            showMessage('ä½ ç»™æ©˜å­æ ‘æ–½äº†è‚¥ã€‚', 'info');
            playSound('fertilizer');

            // ç²’å­ç‰¹æ•ˆ
            const rect = orangeTree.getBoundingClientRect();
            const treeCenterX = rect.left + rect.width / 2;
            const treeBottomY = rect.bottom;
            createParticleEffect(treeCenterX, treeBottomY, 'fertilizer');

            checkGrowth();
            updateGameDisplay();
            saveGame();
        }

        function checkGrowth() {
            if (gameState.treeStage < MAX_TREE_STAGE && gameState.growthProgress >= GROWTH_NEEDED_PER_STAGE) {
                gameState.treeStage++;
                gameState.growthProgress = 0; // é‡ç½®æˆé•¿è¿›åº¦
                showMessage(`æ©˜å­æ ‘é•¿å¤§äº†ï¼ç°åœ¨æ˜¯ç¬¬ ${gameState.treeStage} é˜¶æ®µï¼`, 'success');
                playSound('grow');
                // æ·»åŠ ä¸€ä¸ªçŸ­æš‚çš„ç”Ÿé•¿åŠ¨ç”»ç±»
                orangeTree.classList.add('growing');
                setTimeout(() => {
                    orangeTree.classList.remove('growing');
                }, 800);
            }
        }

        function harvestOrange() {
            if (gameState.treeStage === MAX_TREE_STAGE && gameState.growthProgress >= GROWTH_NEEDED_PER_STAGE) {
                gameState.gold += HARVEST_GOLD;
                gameState.exp += HARVEST_EXP;
                gameState.totalOranges++; // æ©˜å­æ€»æ•°å¢åŠ 
                gameState.treeStage = 0; // æ”¶è·åå›åˆ°ç§å­é˜¶æ®µ
                gameState.growthProgress = 0;
                gameState.waterLevel = 50; // é‡ç½®çŠ¶æ€
                gameState.fertilizerLevel = 50; // é‡ç½®çŠ¶æ€
                showMessage(`æ­å–œï¼ä½ æ”¶è·äº†æ©˜å­ï¼Œè·å¾— ${HARVEST_GOLD} é‡‘å¸å’Œ ${HARVEST_EXP} ç»éªŒï¼`, 'success');
                playSound('harvest');

                // æ©˜å­æ‰è½åŠ¨ç”»ï¼ˆè¿™é‡Œç®€åŒ–ä¸ºç¬é—´æ¶ˆå¤±å¹¶å‡ºç°æ–°æ ‘ï¼‰
                orangeTree.classList.add('harvesting'); // æ·»åŠ ä¸€ä¸ª CSS ç±»æ¥åšæ”¶è·åŠ¨ç”»
                setTimeout(() => {
                    orangeTree.classList.remove('harvesting');
                    updateGameDisplay();
                    saveGame();
                }, 500); // åŠ¨ç”»æŒç»­æ—¶é—´
            } else {
                showMessage('æ©˜å­è¿˜æ²¡æœ‰æˆç†Ÿï¼Œä¸èƒ½æ”¶è·ï¼');
                playSound('error');
            }
        }

        // åˆ‡æ©˜å­åŠŸèƒ½
        function openCutOrangeModal() {
            if (gameState.totalOranges > 0) {
                cutOrangeModal.style.display = 'flex'; // æ˜¾ç¤ºæ¨¡æ€æ¡†
                philosophyQuote.textContent = ''; // æ¸…ç©ºä¹‹å‰çš„è¯­å½•
                playSound('modalOpen');
            } else {
                showMessage('ä½ è¿˜æ²¡æœ‰æ©˜å­å¯ä»¥åˆ‡ï¼', 'error');
            }
        }

        function performCutOrange() {
            if (gameState.totalOranges > 0) {
                gameState.totalOranges--; // æ¶ˆè€—ä¸€ä¸ªæ©˜å­
                const randomIndex = Math.floor(Math.random() * philosophyQuotes.length);
                philosophyQuote.textContent = philosophyQuotes[randomIndex];
                playSound('cut');

                // åˆ‡å¼€æ©˜å­çš„åŠ¨ç”»
                orangeToCut.classList.add('cutting');
                setTimeout(() => {
                    orangeToCut.classList.remove('cutting');
                    updateGameDisplay(); // æ›´æ–°æ©˜å­æ€»æ•°æ˜¾ç¤º
                    saveGame();
                }, 300); // æ¨¡æ‹Ÿåˆ‡å¼€çš„çŸ­æš‚åŠ¨ç”»
            } else {
                showMessage('æ²¡æœ‰æ©˜å­å¯ä»¥åˆ‡äº†ï¼', 'error');
                philosophyQuote.textContent = 'æ²¡æœ‰æ©˜å­å¯ä»¥åˆ‡äº†...';
                playSound('error');
            }
        }

        // è˜‘è‡ç”Ÿæˆ
        function spawnMushroom() {
            // æ¯æ¬¡åªèƒ½æœ‰ä¸€ä¸ªè˜‘è‡åœ¨åœº
            if (mushroomSpawnArea.children.length > 0) { // æ£€æŸ¥æ˜¯å¦æœ‰è˜‘è‡DOMå…ƒç´ 
                return;
            }

            // éšæœºå†³å®šæ˜¯å¦ç”Ÿæˆè˜‘è‡ (ä¾‹å¦‚ 15% æ¦‚ç‡æ¯æ¬¡å¾ªç¯)
            if (Math.random() < 0.15) {
                const availableMushrooms = mushroomTypes.filter(m => m.id !== 'amanita' || gameState.collectedMushrooms['amanita'] === 0); // æ¯’è‡ä¼åªå‡ºç°ä¸€æ¬¡
                if (availableMushrooms.length === 0) return; // å¦‚æœæ²¡æœ‰å¯ç”Ÿæˆçš„è˜‘è‡ï¼Œåˆ™è¿”å›

                const randomMushroomType = availableMushrooms[Math.floor(Math.random() * availableMushrooms.length)];

                const mushroomElement = document.createElement('div');
                mushroomElement.classList.add('mushroom', randomMushroomType.id);
                // ä½¿ç”¨ SVG æ•°æ®ä½œä¸ºèƒŒæ™¯å›¾
                mushroomElement.style.backgroundImage = `url('${randomMushroomType.svg}')`;

                // éšæœºä½ç½®
                const gardenWidth = mushroomSpawnArea.offsetWidth;
                const leftPos = Math.random() * (gardenWidth - 60) + 10; // ç•™å‡ºè¾¹è·
                mushroomElement.style.left = `${leftPos}px`;
                mushroomElement.dataset.mushroomId = randomMushroomType.id; // ä¿å­˜è˜‘è‡ID

                mushroomElement.addEventListener('click', () => pickMushroom(mushroomElement, randomMushroomType));
                mushroomSpawnArea.appendChild(mushroomElement);
                showMessage(`æ©˜å­æ ‘ä¸‹é•¿å‡ºäº†ä¸€é¢— ${randomMushroomType.name}ï¼å¿«ç‚¹å‡»å®ƒé‡‡æ‘˜å§ï¼`, 'info');
                saveGame();
            }
        }

        // é‡‡æ‘˜è˜‘è‡
        function pickMushroom(mushroomElement, mushroomType) {
            playSound('mushroomPick');
            mushroomElement.remove(); // ä»DOMä¸­ç§»é™¤è˜‘è‡

            gameState.collectedMushrooms[mushroomType.id]++; // å¢åŠ æ”¶é›†æ•°é‡
            gameState.exp += 10; // é‡‡æ‘˜è˜‘è‡è·å¾—ç»éªŒ
            showMessage(`ä½ é‡‡æ‘˜äº†ä¸€é¢— ${mushroomType.name}ï¼ç»éªŒ +10ã€‚`, 'success');
            updateGameDisplay();
            saveGame();
        }

        // æ‰“å¼€è˜‘è‡æ”¶é›†åº“
        function openMushroomCollectionModal() {
            mushroomCollectionModal.style.display = 'flex';
            playSound('modalOpen');
            renderMushroomGallery();
        }

        // æ¸²æŸ“è˜‘è‡å›¾é‰´
        function renderMushroomGallery() {
            mushroomGallery.innerHTML = ''; // æ¸…ç©ºç°æœ‰å†…å®¹

            mushroomTypes.forEach(mushroom => {
                const card = document.createElement('div');
                card.classList.add('mushroom-card');

                const isCollected = gameState.collectedMushrooms[mushroom.id] > 0;
                if (isCollected) {
                    card.classList.add('collected');
                }

                const img = document.createElement('img');
                img.src = mushroom.svg; // ä½¿ç”¨è˜‘è‡ç±»å‹ä¸­å®šä¹‰çš„ SVG æ•°æ®
                img.alt = mushroom.name;

                const nameP = document.createElement('p');
                nameP.textContent = isCollected ? mushroom.name : '???';
                nameP.title = isCollected ? mushroom.description : 'æœªå‘ç°çš„è˜‘è‡'; // é¼ æ ‡æ‚¬åœæ˜¾ç¤ºæè¿°

                const countP = document.createElement('p');
                countP.textContent = isCollected ? `æ•°é‡: ${gameState.collectedMushrooms[mushroom.id]}` : 'æœªæ”¶é›†';

                card.appendChild(img);
                card.appendChild(nameP);
                card.appendChild(countP);
                mushroomGallery.appendChild(card);
            });
        }

        // æ‰“å¼€æ¸¸æˆè¯´æ˜æ¨¡æ€æ¡†
        function openGameInfoModal() {
            gameInfoModal.style.display = 'flex';
            playSound('modalOpen');
        }

        // å…³é—­æ¨¡æ€æ¡†é€šç”¨å‡½æ•°
        closeButtons.forEach(btn => {
            btn.addEventListener('click', () => {
                btn.closest('.modal').style.display = 'none';
                playSound('modalClose');
            });
        });

        window.addEventListener('click', (event) => {
            if (event.target === cutOrangeModal) {
                cutOrangeModal.style.display = 'none';
                playSound('modalClose');
            }
            if (event.target === mushroomCollectionModal) {
                mushroomCollectionModal.style.display = 'none';
                playSound('modalClose');
            }
            if (event.target === gameInfoModal) {
                gameInfoModal.style.display = 'none';
                playSound('modalClose');
            }
        });


        // --- äº‹ä»¶ç›‘å¬ ---
        waterBtn.addEventListener('click', waterTree);
        fertilizeBtn.addEventListener('click', fertilizeTree);
        harvestBtn.addEventListener('click', harvestOrange);
        cutOrangeBtn.addEventListener('click', openCutOrangeModal);
        performCutBtn.addEventListener('click', performCutOrange);
        mushroomCollectionBtn.addEventListener('click', openMushroomCollectionModal);
        gameInfoBtn.addEventListener('click', openGameInfoModal); // æ¸¸æˆè¯´æ˜æŒ‰é’®äº‹ä»¶ç›‘å¬


        // --- æ¸¸æˆå¾ªç¯ (æ¨¡æ‹Ÿæ—¶é—´æµé€å’ŒçŠ¶æ€è¡°å‡) ---
        function gameLoop() {
            // æ¨¡æ‹Ÿæ°´ä»½å’Œè‚¥æ–™æµå¤±
            gameState.waterLevel = Math.max(0, gameState.waterLevel - WATER_DECAY_RATE / 2); // æ¯ç§’è¡°å‡
            gameState.fertilizerLevel = Math.max(0, gameState.fertilizerLevel - FERTILIZER_DECAY_RATE / 2);

            // éšæœºå°è¯•ç”Ÿæˆè˜‘è‡
            spawnMushroom();

            updateGameDisplay();
        }

        // æ¯500æ¯«ç§’ï¼ˆ0.5ç§’ï¼‰è¿è¡Œä¸€æ¬¡æ¸¸æˆå¾ªç¯
        setInterval(gameLoop, 500);

        // æ¯10ç§’è‡ªåŠ¨ä¿å­˜ä¸€æ¬¡ (é™¤äº†æ¯æ¬¡æ“ä½œåä¿å­˜)
        setInterval(saveGame, 10000);

        // --- åˆå§‹åŒ–æ¸¸æˆ ---
        document.addEventListener('DOMContentLoaded', () => {
            loadGame();
            updateGameDisplay(); // åˆå§‹åŠ è½½åæ›´æ–°ä¸€æ¬¡æ˜¾ç¤º
        });

        // åœ¨é¡µé¢å…³é—­æˆ–åˆ·æ–°å‰ä¿å­˜æ•°æ®
        window.addEventListener('beforeunload', saveGame);
    </script>
</body>
</html>
